CREATE TABLE `fa_shower_room` (`room_id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,`agent_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`room_name` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '浴室名称(XXX号楼xxx层xx北区)',`block_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`available_sex` tinyint(5) UNSIGNED NOT NULL DEFAULT 0 COMMENT '可用性别 0女 1男',PRIMARY KEY (`room_id`) )COMMENT='浴室';insert into fa_shower_room(agent_id,room_name,block_id,available_sex) values(1,'5-4-2',1,1);CREATE TABLE `fa_shower_cell` (`cell_id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,`agent_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`cell_name` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '浴间名称',`block_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`room_id` int(11) UNSIGNED NOT NULL DEFAULT 0,PRIMARY KEY (`cell_id`) )COMMENT='浴室单间';insert into fa_shower_cell(agent_id,cell_name,block_id,room_id) values(1,'5-4-1-1',1,1);CREATE TABLE `fa_shower_promise` (`promise_id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,`user_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`block_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`room_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`cell_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`begin_time` int(11) UNSIGNED NOT NULL DEFAULT 0,`end_time` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '预约结束时间',`expire_time` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '预约过期时间',`status` tinyint(5) UNSIGNED NOT NULL DEFAULT 1 COMMENT '状态',`create_time` int(11) UNSIGNED NOT NULL DEFAULT 0,PRIMARY KEY (`promise_id`) )COMMENT='预约';insert into fa_shower_promise(user_id,block_id,room_id,cell_id,begin_time,end_time,expire_time,create_time) values(1,1,1,1,1707021900,1707021930,1707021915,1707021800);insert into fa_shower_promise(user_id,block_id,room_id,cell_id,begin_time,end_time,expire_time,create_time) values(2,1,1,3,1707021200,1707021215,1707021215,1707021032);insert into fa_shower_promise(user_id,block_id,room_id,cell_id,begin_time,end_time,expire_time,create_time) values(3,1,1,5,1707021000,1707021020,1707021015,1707020930);insert into fa_shower_promise(user_id,block_id,room_id,cell_id,begin_time,end_time,expire_time,create_time) values(4,1,1,2,1707021030,1707021040,1707021040,1707020800);insert into fa_shower_promise(user_id,block_id,room_id,cell_id,begin_time,end_time,expire_time,create_time) values(5,1,3,6,1707021305,1707021030,1707021320,1707021123);insert into fa_shower_promise(user_id,block_id,room_id,cell_id,begin_time,end_time,expire_time,create_time) values(6,1,4,7,1707021900,1707021930,1707021915,1707021800);CREATE TABLE `fa_shower_order` (`order_id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,`order_sn` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '订单号',`use_time` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '秒',`begin_time` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '使用开始时间',`end_time` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '使用结束时间',`order_status` tinyint(5) NOT NULL DEFAULT 1 COMMENT '订单状态',`pay_status` tinyint(5) UNSIGNED NOT NULL DEFAULT 0 COMMENT '支付状态',`refund_sn` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '退款订单',`refund_status` tinyint(5) UNSIGNED NOT NULL DEFAULT 0 COMMENT '退款状态',`coupon_sn` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '优惠券单号',`price` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '价格',`total_money` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '总金额',`amount` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '付款金额',`deduction_amount` int(11) NOT NULL DEFAULT 0 COMMENT '优惠金额',`refund_money` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '退款金额',`user_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`block_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`room_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`cell_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`create_time` int(11) UNSIGNED NOT NULL DEFAULT 0,`dosage` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '用量(use_time/60/30)ceil',`coupon_id` int(11) UNSIGNED NOT NULL DEFAULT 0,PRIMARY KEY (`order_id`) )COMMENT='订单';insert into fa_shower_order(order_sn,use_time,begin_time,end_time,price,total_money,user_id,block_id,room_id,cell_id,create_time,dosage) values('20170702001',1800,1707021900,1707021930,0.1,3.0,1,1,1,1,1707021800,1);insert into fa_shower_order(order_sn,use_time,begin_time,end_time,price,total_money,user_id,block_id,room_id,cell_id,create_time,dosage) values('20170702002',900,1707021200,1707021215,0.1,1.5,2,1,1,3,1707021032,1);insert into fa_shower_order(order_sn,use_time,begin_time,end_time,price,total_money,user_id,block_id,room_id,cell_id,create_time,dosage) values('20170702003',1200,1707021000,1707021020,0.1,2.0,3,1,1,5,1707020930,1);insert into fa_shower_order(order_sn,use_time,begin_time,end_time,price,total_money,user_id,block_id,room_id,cell_id,create_time,dosage) values('20170702004',600,1707021030,1707021040,0.1,1.0,4,1,1,2,1707020800,1);insert into fa_shower_order(order_sn,use_time,begin_time,end_time,price,total_money,user_id,block_id,room_id,cell_id,create_time,dosage) values('20170702005',1500,1707021305,1707021030,0.1,2.5,5,1,3,6,1707021123,1);insert into fa_shower_order(order_sn,use_time,begin_time,end_time,price,total_money,user_id,block_id,room_id,cell_id,create_time,dosage) values('20170702001',1800,1707021900,1707021930,0.1,3.0,6,1,4,7,1707021800,1);CREATE TABLE `fa_shower_block` (`block_id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,`agent_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`block_name` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '区域名称(XXX学校)',PRIMARY KEY (`block_id`) )COMMENT='块区/片区';CREATE TABLE `fa_shower_deposit` (`deposit_id` int(11) UNSIGNED NOT NULL,`user_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`promise_id` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '预约id',`total_money` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '总押金',`amount` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '押金',`deposit_sn` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`pay_status` tinyint(5) UNSIGNED NOT NULL DEFAULT 0 COMMENT '0未支付 1支付 2退款',PRIMARY KEY (`deposit_id`) )COMMENT='押金';CREATE TABLE `fa_shower_payment` (`payment_id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,`appid` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`mch_id` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`nonce_str` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`sign` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`sign_type` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`result_code` varchar(10) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`err_code` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`err_code_des` varchar(200) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`openid` varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`is_subscribe` varchar(10) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`trade_type` varchar(10) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`bank_type` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`total_fee` int(11) UNSIGNED NOT NULL DEFAULT 0,`settlement_total_fee` int(11) UNSIGNED NOT NULL DEFAULT 0,`fee_type` varchar(10) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`cash_fee` int(11) UNSIGNED NOT NULL DEFAULT 0,`coupon_fee` int(11) UNSIGNED NOT NULL DEFAULT 0,`transaction_id` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`out_trade_no` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`attach` varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`time_end` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',PRIMARY KEY (`payment_id`) );CREATE TABLE `fa_shower_user` (`user_id` int UNSIGNED NOT NULL AUTO_INCREMENT,`nickname` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`openid` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`sex` tinyint(5) UNSIGNED NOT NULL DEFAULT 0,`province` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`city` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`country` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`headimgurl` varchar(400) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`money` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '余额',`credit` int(11) UNSIGNED NOT NULL DEFAULT 100 COMMENT '信誉点数',`user_key` varchar(18) not null COMMENT '使用密码',`room_name` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '浴室名称(XXX号楼xxx层xx北区)',`block_name` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '区域名称(XXX学校)',`tel` varchar(11) not null UNIQUE DEFAULT '' COMMENT '手机号',PRIMARY KEY (`user_id`) )COMMENT='智慧洗浴用户';alter table fa_shower_user add unique(`tel`);insert into fa_shower_user values(4,'牛新宇','oYtFg1GvglI89NfOj6A8ATod94Ws',0,'山东省','济南市','济阳县','123','100','100');update fa_shower_user SET sex = 0 where sex = 10;CREATE TABLE `fa_shower_device` (`device_id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,`agent_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`device_name` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '设备名称',`desc` varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`block_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`room_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`cell_id` int(11) UNSIGNED NOT NULL DEFAULT 0,PRIMARY KEY (`device_id`) )COMMENT='浴室设备';CREATE TABLE `fa_shower_agent` (`agent_id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,`agent_name` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '代理商名称',`admin_id` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '绑定admin用户',PRIMARY KEY (`agent_id`) )COMMENT='代理商';insert into fa_shower_agent(agent_name,admin_id) values('First代理商',1);CREATE TABLE `fa_shower_coupon` (`coupon_id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,`coupon_sn` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '优惠券号',`user_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`channel_id` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '渠道',`add_time` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '添加时间',`expire_time` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '过期时间',`use_time` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '使用时间',`scene_id` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '优惠券场景id',`scene_sn` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '优惠券场景代号',`type` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '类型',`status` tinyint(5) UNSIGNED NOT NULL DEFAULT 1 COMMENT '1可用 2已用 3过期',`create_time` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '创建时间',PRIMARY KEY (`coupon_id`) )COMMENT='优惠券';CREATE TABLE `fa_shower_coupon_scene` (`scene_id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,`scene_sn` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`channel_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`channel_sn` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '渠道sn',`title` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '名目',`slug` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`desc` varchar(500) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`type` tinyint(5) UNSIGNED NOT NULL DEFAULT 1 COMMENT '1现金券、2满减券、3折扣券',`scope` tinyint(5) UNSIGNED NOT NULL DEFAULT 1 COMMENT '1全部 2代理商 3区域 4浴室 5 浴间 6设备(暂不考虑6)',`limit` int(11) UNSIGNED NOT NULL DEFAULT 500 COMMENT '上限金额 单位 分',`agent_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`block_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`room_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`cell_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`device_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`condition` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'once' COMMENT '条件 once一次性 expire限时券',`begin_time` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '开始领取时间',`end_time` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '结束领取时间',`available_begin_time` int(11) UNSIGNED NOT NULL DEFAULT 0,`available_end_time` int(11) UNSIGNED NOT NULL DEFAULT 0,`status` tinyint(5) UNSIGNED NOT NULL DEFAULT 0 COMMENT '0不可用 1可用',`create_time` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '创建时间',PRIMARY KEY (`scene_id`) )COMMENT='优惠券场景';CREATE TABLE `fa_shower_channel` (`channel_id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,`channel_sn` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`name` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',`admin_id` int(11) UNSIGNED NOT NULL DEFAULT 0,`desc` varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '描述',`create_time` int(11) UNSIGNED NOT NULL DEFAULT 0,`status` tinyint(5) UNSIGNED NOT NULL DEFAULT 1 COMMENT '0 不可用 1可用',PRIMARY KEY (`channel_id`) )COMMENT='渠道';CREATE TABLE `fa_shower_orderproblem` (`op_id` int UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY COMMENT '订单问题id',`order_id` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '订单id',`user_id` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '用户id',`block_id` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '片区id',`room_id` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '浴室id',`cell_id` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '单间id',`device_id` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '浴室设备id',`agent_id` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '代理商id',`op_desc` varchar(500) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '订单问题描述',`op_type` varchar(32) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '问题类型',`create_time` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '创建时间',)COMMENT='订单问题反馈';CREATE TABLE `fa_shower_opinion` (`opinion_id` int UNSIGNED NOT NULL AUTO_INCREMENT primary key,`user_id` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '用户id',`opinion_desc` varchar(500) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '用户意见描述',`create_time` int(11) UNSIGNED NOT NULL DEFAULT 0 COMMENT '创建时间',`opinion_type` varchar(32) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '意见类型')COMMENT='用户意见反馈';